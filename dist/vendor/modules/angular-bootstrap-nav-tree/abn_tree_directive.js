(function(){var a;a=angular.module("angularBootstrapNavTree",[]),a.directive("abnTree",["$timeout",function(a){return{restrict:"E",template:'<ul class="nav nav-list nav-pills nav-stacked abn-tree">\n  <li ng-repeat="row in tree_rows | filter:{visible:true} track by row.branch.uid" ng-animate="\'abn-tree-animate\'" ng-class="\'level-\' + {{ row.level }} + (row.branch.selected ? \' active\':\'\')" class="abn-tree-row">\n    <a ng-click="user_clicks_branch(row.branch)">\n      <i ng-class="row.tree_icon" ng-click="row.branch.expanded = !row.branch.expanded" class="indented tree-icon"> </i>\n      <span class="indented tree-label">{{ row.label }} </span>\n    </a>\n  </li>\n</ul>',replace:!0,scope:{treeData:"=",onSelect:"&",initialSelection:"@",treeControl:"="},link:function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o;if(e=function(a){return void console.log("ERROR:"+a)},null==d.iconExpand&&(d.iconExpand="icon-plus  glyphicon glyphicon-plus  fa fa-plus"),null==d.iconCollapse&&(d.iconCollapse="icon-minus glyphicon glyphicon-minus fa fa-minus"),null==d.iconLeaf&&(d.iconLeaf="icon-file  glyphicon glyphicon-file  fa fa-file"),null==d.expandLevel&&(d.expandLevel="3"),g=parseInt(d.expandLevel,10),!b.treeData)return void alert("no treeData defined for the tree!");if(null==b.treeData.length){if(null==treeData.label)return void alert("treeData should be an array of root branches");b.treeData=[treeData]}return i=function(a){var c,d,e,f,g,h;for(c=function(b,d){var e,f,g,h,i;if(a(b,d),null!=b.children){for(h=b.children,i=[],f=0,g=h.length;g>f;f++)e=h[f],i.push(c(e,d+1));return i}},g=b.treeData,h=[],e=0,f=g.length;f>e;e++)d=g[e],h.push(c(d,1));return h},n=null,m=function(c){if(!c)return null!=n&&(n.selected=!1),void(n=null);if(c!==n){if(null!=n&&(n.selected=!1),c.selected=!0,n=c,f(c),null!=c.onSelect)return a(function(){return c.onSelect(c)});if(null!=b.onSelect)return a(function(){return b.onSelect({branch:c})})}},b.user_clicks_branch=function(a){return a!==n?m(a):void 0},j=function(a){var b;return b=void 0,a.parent_uid&&i(function(c){return c.uid===a.parent_uid?b=c:void 0}),b},h=function(a,b){var c;return c=j(a),null!=c?(b(c),h(c,b)):void 0},f=function(a){return h(a,function(a){return a.expanded=!0})},b.tree_rows=[],l=function(){var a,c,e,f,g,h;for(i(function(a){return a.uid?void 0:a.uid=""+Math.random()}),console.log("UIDs are set."),i(function(a){var b,c,d,e,f;if(angular.isArray(a.children)){for(e=a.children,f=[],c=0,d=e.length;d>c;c++)b=e[c],f.push(b.parent_uid=a.uid);return f}}),b.tree_rows=[],i(function(a){var b,c;return a.children?a.children.length>0?(c=function(a){return"string"==typeof a?{label:a,children:[]}:a},a.children=function(){var d,e,f,g;for(f=a.children,g=[],d=0,e=f.length;e>d;d++)b=f[d],g.push(c(b));return g}()):void 0:a.children=[]}),a=function(c,e,f){var g,h,i,j,k,l,m;if(null==e.expanded&&(e.expanded=!1),i=e.children&&0!==e.children.length?e.expanded?d.iconCollapse:d.iconExpand:d.iconLeaf,b.tree_rows.push({level:c,branch:e,label:e.label,tree_icon:i,visible:f}),null!=e.children){for(l=e.children,m=[],j=0,k=l.length;k>j;j++)g=l[j],h=f&&e.expanded,m.push(a(c+1,g,h));return m}},g=b.treeData,h=[],e=0,f=g.length;f>e;e++)c=g[e],h.push(a(1,c,!0));return h},b.$watch("treeData",l,!0),null!=d.initialSelection&&i(function(b){return b.label===d.initialSelection?a(function(){return m(b)}):void 0}),k=b.treeData.length,console.log("num root branches = "+k),i(function(a,b){return a.level=b,a.expanded=a.level<g}),null!=b.treeControl&&angular.isObject(b.treeControl)?(o=b.treeControl,o.expand_all=function(){return i(function(a){return a.expanded=!0})},o.collapse_all=function(){return i(function(a){return a.expanded=!1})},o.get_first_branch=function(){return k=b.treeData.length,k>0?b.treeData[0]:void 0},o.select_first_branch=function(){var a;return a=o.get_first_branch(),o.select_branch(a)},o.get_selected_branch=function(){return n},o.get_parent_branch=function(a){return j(a)},o.select_branch=function(a){return m(a),a},o.get_children=function(a){return a.children},o.select_parent_branch=function(a){var b;return null==a&&(a=o.get_selected_branch()),null!=a&&(b=o.get_parent_branch(a),null!=b)?(o.select_branch(b),b):void 0},o.add_branch=function(a,c){return null!=a?(a.children.push(c),a.expanded=!0):b.treeData.push(c),c},o.add_root_branch=function(a){return o.add_branch(null,a),a},o.expand_branch=function(a){return null==a&&(a=o.get_selected_branch()),null!=a?(a.expanded=!0,a):void 0},o.collapse_branch=function(a){return null==a&&(a=n),null!=a?(a.expanded=!1,a):void 0},o.get_siblings=function(a){var c,d;return null==a&&(a=n),null!=a?(c=o.get_parent_branch(a),d=c?c.children:b.treeData):void 0},o.get_next_sibling=function(a){var b,c;return null==a&&(a=n),null!=a&&(c=o.get_siblings(a),k=c.length,b=c.indexOf(a),k>b)?c[b+1]:void 0},o.get_prev_sibling=function(a){var b,c;return null==a&&(a=n),c=o.get_siblings(a),k=c.length,b=c.indexOf(a),b>0?c[b-1]:void 0},o.select_next_sibling=function(a){var b;return null==a&&(a=n),null!=a&&(b=o.get_next_sibling(a),null!=b)?o.select_branch(b):void 0},o.select_prev_sibling=function(a){var b;return null==a&&(a=n),null!=a&&(b=o.get_prev_sibling(a),null!=b)?o.select_branch(b):void 0},o.get_first_child=function(a){var b;return null==a&&(a=n),null!=a&&(null!=(b=a.children)?b.length:void 0)>0?a.children[0]:void 0},o.get_closest_ancestor_next_sibling=function(a){var b,c;return b=o.get_next_sibling(a),null!=b?b:(c=o.get_parent_branch(a),o.get_closest_ancestor_next_sibling(c))},o.get_next_branch=function(a){var b;return null==a&&(a=n),null!=a?(b=o.get_first_child(a),null!=b?b:b=o.get_closest_ancestor_next_sibling(a)):void 0},o.select_next_branch=function(a){var b;return null==a&&(a=n),null!=a&&(b=o.get_next_branch(a),null!=b)?(o.select_branch(b),b):void 0},o.last_descendant=function(a){var b;return k=a.children.length,0===k?a:(b=a.children[k-1],o.last_descendant(b))},o.get_prev_branch=function(a){var b,c;return null==a&&(a=n),null!=a?(c=o.get_prev_sibling(a),null!=c?o.last_descendant(c):b=o.get_parent_branch(a)):void 0},o.select_prev_branch=function(a){var b;return null==a&&(a=n),null!=a&&(b=o.get_prev_branch(a),null!=b)?(o.select_branch(b),b):void 0}):void 0}}}])}).call(this);